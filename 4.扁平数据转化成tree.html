<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>扁平数据转化</title>
</head>

<body>
  <script>
    const arr = [{
        id: 2,
        name: '部门2',
        pid: 1
      },
      {
        id: 3,
        name: '部门3',
        pid: 1
      },
      {
        id: 1,
        name: '部门1',
        pid: 0
      },
      {
        id: 4,
        name: '部门4',
        pid: 3
      },
      {
        id: 5,
        name: '部门5',
        pid: 4
      },
      {
        id: 6,
        name: '部门6',
        pid: 5
      },
      {
        id: 7,
        name: '部门7',
        pid: 2
      },
    ];

    const dataReturnTree = (data) => {
      const treeArr = [];
      const dataMap = {}
      data.forEach((item) => {
        const {
          id,
          pid
        } = item;
        dataMap[id] = {
          ...item,
          children: []
        }
        if (pid === 0) treeArr.push(dataMap[id])
      })
      for (let key in dataMap) {
        const pid = dataMap[key].pid
        if (pid in dataMap) {
          dataMap[pid].children.push(dataMap[key])
        }
      }
      console.log('dataMap:::', dataMap)
      return treeArr
    }
    console.log(dataReturnTree(arr))
  </script>
</body>

</html>